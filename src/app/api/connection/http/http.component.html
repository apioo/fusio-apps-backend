
<h1>
  <a [routerLink]="['/', 'connection']">Connection</a> /
  <a [routerLink]="['/', 'connection', selectedConnection?.id]">{{selectedConnection?.name}}</a> /
  HTTP
</h1>

<fusio-message [response]="message"></fusio-message>

<div class="row">
  <div class="col-xl-6">
    <div class="card">
      <div class="card-header">Request</div>
      <div class="card-body">
        <form>
          <div class="mb-3 row">
            <label for="method" class="col-xl-2 col-form-label fw-bold">Method</label>
            <div class="col-xl-10">
              <select name="method" id="method" [(ngModel)]="method" class="form-select">
                <option ngValue="GET">GET</option>
                <option ngValue="POST">POST</option>
                <option ngValue="PUT">PUT</option>
                <option ngValue="PATCH">PATCH</option>
                <option ngValue="DELETE">DELETE</option>
              </select>
            </div>
          </div>
          <div class="mb-3 row">
            <label for="uri" class="col-xl-2 col-form-label fw-bold">URI</label>
            <div class="col-xl-10">
              <input type="text" name="uri" id="uri" [(ngModel)]="uri" placeholder="/my/endpoint" class="form-control">
            </div>
          </div>
          <div class="mb-3 row">
            <label for="headers" class="col-xl-2 col-form-label fw-bold">Headers</label>
            <div class="col-xl-10">
              <fusio-form-map name="headers" [data]="headers" (dataChange)="headers = $event"></fusio-form-map>
            </div>
          </div>
          <div class="mb-3 row">
            <label for="body" class="col-xl-2 col-form-label fw-bold">Body</label>
            <div class="col-xl-10">
              <div style="width:100%;height:300px;border:1px solid #ced4da">
                <ngx-monaco-editor style="height:100%" name="body" [options]="{theme: 'vs-light', language: 'json'}" [(ngModel)]="body"></ngx-monaco-editor>
              </div>
            </div>
          </div>
          <div class="btn-group">
            <button type="button" class="btn btn-primary" (click)="send()">Send</button>
          </div>
        </form>
      </div>
    </div>
  </div>
  <div class="col-xl-6 mt-3 mt-xl-0">
    <div class="card">
      <div class="card-header" [ngClass]="{'text-bg-success': statusCode >= 200 && statusCode < 300, 'text-bg-warning': statusCode >= 400 && statusCode < 500, 'text-bg-danger': statusCode >= 500 && statusCode < 600}">Response @if (statusCode > 0) {<span> - {{statusCode}}</span>}</div>
      @if (response) {
        <div class="card-body">
        <pre>@for (header of response.headers|keyvalue; track $index) {{{header.key}}: {{header.value}}
}</pre>
          <div style="width:100%;height:500px;border:1px solid #ced4da" class="mt-3">
            <ngx-monaco-editor style="height:100%" name="body" [options]="{theme: 'vs-light', language: 'json'}" [(ngModel)]="response.body"></ngx-monaco-editor>
          </div>
        </div>
      }
    </div>
  </div>
</div>
